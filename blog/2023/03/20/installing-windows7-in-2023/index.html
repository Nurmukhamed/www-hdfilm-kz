<!doctype html><html lang=ru><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Устанавливаем Windows 7 в 2023 году.
Введение С 2021 года основной операционной системой у меня является Ubuntu Linux. Рабочий ноутбук сейчас Apple MacBook Air M2. Но у меня еще есть старенький ноутбук Lenovo Thinkpad X201i, который был куплен мной в 2010 году (за сумашедшие тогда 320.000 тенге). К сожалению, я не знаю как убить этот ноутбук. На этом ноутбуке успешно была установлена Ubuntu Linux, i3. Медленно, но стабильно работало. Для ускорения я также собрал ядро с минимальным количеством модулей."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Устанавливаем Windows 7 в 2023 году. • Нұрмұхамед Артықалы"><meta property="og:description" content="Устанавливаем Windows 7 в 2023 году.
Введение С 2021 года основной операционной системой у меня является Ubuntu Linux. Рабочий ноутбук сейчас Apple MacBook Air M2. Но у меня еще есть старенький ноутбук Lenovo Thinkpad X201i, который был куплен мной в 2010 году (за сумашедшие тогда 320.000 тенге). К сожалению, я не знаю как убить этот ноутбук. На этом ноутбуке успешно была установлена Ubuntu Linux, i3. Медленно, но стабильно работало. Для ускорения я также собрал ядро с минимальным количеством модулей."><meta property="og:url" content="https://www.hdfilm.kz/blog/2023/03/20/installing-windows7-in-2023/"><meta property="og:site_name" content="Нұрмұхамед Артықалы"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2023-03-20T00:00:00Z"><meta property="article:modified_time" content="2023-03-20T00:00:00Z"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.116.1"><title>Устанавливаем Windows 7 в 2023 году. • Нұрмұхамед Артықалы</title><link rel=canonical href=https://www.hdfilm.kz/blog/2023/03/20/installing-windows7-in-2023/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.6a060eb7.css><link rel=stylesheet href=/css/custom.css><style>:root{--color-accent:#ffcd00}</style></head><body class='page type-blog layout-page has-sidebar'><div class=site><div id=sidebar class=sidebar><a class=screen-reader-text href=#main-menu></a><div class=container><section class='widget widget-about sep-after'><header><div class=logo><a href=/><img src=/images/logo.png></a></div><h2 class='title site-title'><a href=/>Нұрмұхамед Артықалы</a></h2><div class=desc>Нұрмұхамед Артықалы - IT-инженер, сисадмин, программист, DevOps, SRE. Изучает новые технологии и занимается борьбой. Блог посвящен IT технологиям и (или) событиями, связанными с IT в Казахстане, СНГ и в мире.</div></header></section><section class='widget widget-search sep-after'><header><h4 class='title widget-title'>Search</h4></header><form action=/search id=search-form class=search-form><label><span class=screen-reader-text></span>
<input id=search-term class=search-term type=search name=q placeholder=&mldr;></label></form></section><section class='widget widget-taxonomy_cloud sep-after'><header><h4 class='title widget-title'></h4></header><div class='container list-container'><ul class='list taxonomy-cloud'><span></span></ul></div></section></div><div class=sidebar-overlay></div></div><div class=main><nav id=main-menu class='menu main-menu' aria-label><div class=container><a class=screen-reader-text href=#content></a>
<button id=sidebar-toggler class=sidebar-toggler aria-controls=sidebar>
<span class=screen-reader-text></span>
<span class=open><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></span><span class=close><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></span></button><ul><li class=item><a href=/about.md>About</a></li><li class=item><a href=/blog/>Blog</a></li><li class=item><a href=/coreos/>CoreOS</a></li><li class=item><a href=/kubernetes/>Kubernetes</a></li><li class=item><a href=https://github.com/Nurmukhamed/www-hdfilm-kz-octopress>Repo</a></li><li class=item><a href=/cv.pdf>Резюме</a></li></ul></div></nav><div class=header-widgets><div class=container></div></div><header id=header class='header site-header'><div class='container sep-after'><div class=header-info><p class='site-title title'>Нұрмұхамед Артықалы</p><p class='desc site-desc'>Нұрмұхамед Артықалы - IT-инженер, сисадмин, программист, DevOps, SRE. Изучает новые технологии и занимается борьбой. Блог посвящен IT технологиям и (или) событиями, связанными с IT в Казахстане, СНГ и в мире.</p></div></div></header><main id=content><article lang=ru class=entry><header class='header entry-header'><div class='container sep-after'><div class=header-info><h1 class=title>Устанавливаем Windows 7 в 2023 году.</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text></span><time class=entry-date datetime=2023-03-20T00:00:00Z>2023, Mar 20</time></span>
<span class=reading-time><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg></span></div></div></header><div class='container entry-content'><p><strong>Устанавливаем Windows 7 в 2023 году.</strong></p><h1 id=введение>Введение</h1><p>С 2021 года основной операционной системой у меня является Ubuntu Linux. Рабочий ноутбук сейчас Apple MacBook Air M2.
Но у меня еще есть старенький ноутбук Lenovo Thinkpad X201i, который был куплен мной в 2010 году (за сумашедшие тогда 320.000 тенге).
К сожалению, я не знаю как убить этот ноутбук. На этом ноутбуке успешно была установлена Ubuntu Linux, i3. Медленно, но стабильно работало.
Для ускорения я также собрал ядро с минимальным количеством модулей.</p><p>В данный момент мое хобби - сканировать домашний архив документов и фотографии, который достался мне от дедушки с бабушкой. Я пробывал сканировать под
Ubuntu, но картинка более тусклая чем под Windows + IrfanView. Поэтому было решено установить Windows 7 (родная для ноутбука операционная система).</p><p>Расскажу о проблемах. Работы я проводил в ночь с субботы на воскресенье, допустил пару ошибок, которые обеспечили работу до 3х часов ночи (или утра).</p><h1 id=кабель-micky--mouse>Кабель Micky Mouse</h1><p>Есть домашний сервер на Ubuntu, который еще работает как медиа-центр. Подключен к розетке через кабель Микимаус. На блоке питания ноутбука тоже Микимаус.
И такой кабель у меня только один.</p><p>Когда нужен был ноутбук, отключал домашний сервер. Когда нужен был домашний сервер, отключал ноутбук.</p><h1 id=загрузочный-носитель-информации>Загрузочный носитель информации</h1><p>Я купил новую флешку на 32 ГБ, нашел статью как <a href="https://wiki.networksecuritytoolkit.org/nstwiki/index.php?title=HowTo_Create_A_GPT_Disk_With_EFI_System_And_exFAT_Partitions_Using_Parted">форматировать флешку правильным образом</a>. Затем нужно было найти <a href=https://windows64.net/99-windows-7-professional-x64-originalnyy-obraz-sp1.html>образ Windows 7</a>.
Так как у меня ноутбук шел с предустановленной версией Windows, то скачивание образа Windows не является нарушением лицензионного соглашения.</p><ul><li>Примонтировал флешку;</li><li>примонтировал iso образ;</li><li>скопировал данные на флешку;</li><li>сделал флешку загрузочной;</li><li>воткнул в ноутбук;</li><li>загрузился в БИОС, не вижу флешку.</li></ul><h1 id=решаем-вопрос-с-загрузкой>Решаем вопрос с загрузкой</h1><p>На ноутбуке установлена Ubuntu, поэтому я решил отредактировать <a href="https://wiki.syslinux.org/wiki/index.php?title=MEMDISK">Grub2</a>, чтобы можно было загрузить <a href=https://boot.ipxe.org/ipxe.iso>iso образ ipxe</a>.</p><p>Созрел следующий план действии:</p><ul><li>Загружаемся в ipxe;</li><li>Быстро нажимаем CTRL+B;</li><li>Набираем команду dhcp;</li><li>На MacBook монтируем iso образ Windows. Дисковая утилита -> Файл -> Открыть образ диска -> Выбираем образ;</li><li>На MacBook создадим новую папку wimboot, скопируем туда следующие файлы:</li><li><ul><li>bcd;</li></ul></li><li><ul><li>boot.sdi;</li></ul></li><li><ul><li>boot.wim;</li></ul></li><li><ul><li>bootmgr;</li></ul></li><li><ul><li>fonts/boot.ttf;</li></ul></li><li><ul><li>fonts/segmono.ttf;</li></ul></li><li><ul><li>fonts/segoe_slboot.ttf;</li></ul></li><li><ul><li>fonts/segoen_slboot.ttf;</li></ul></li><li><ul><li>fonts/wgl4_boot.ttf;</li></ul></li><li><ul><li><a href=https://ipxe.org/wimboot>wimboot</a>;</li></ul></li><li>На MacBook нужно поднять веб-сервер, самый простой способ это сделать - python3</li><li><ul><li>python3 -m http.server в каталоге wimboot</li></ul></li><li>Создаем скрипт ipxe - boot.ipxe;</li></ul><pre tabindex=0><code>#!ipxe
  
set base http://MACBOOKIP:8000
kernel ${base}/wimboot
initrd ${base}/bootmgr bootmgr
initrd ${base}/install.bat install.bat
initrd ${base}/winpeshl.ini winpeshl.ini
initrd ${base}/bcd BCD
initrd ${base}/boot.sdi boot.sdi
initrd ${base}/boot.wim boot.wim
initrd ${base}/fonts/segmono_boot.ttf segmono_boot.ttf
initrd ${base}/fonts/segoe_slboot.ttf segoe_slboot.ttf
initrd ${base}/fonts/segoen_slboot.ttf segoen_slboot.ttf
initrd ${base}/fonts/wgl4_boot.ttf wgl4_boot.ttf
boot
</code></pre><ul><li>Переписываем/переопределяем <a href=https://ipxe.org/howto/winpe>скрипты winpe</a></li><li><ul><li>install.bat;</li></ul></li></ul><pre tabindex=0><code>wpeinit
start /wait cmd.exe
</code></pre><ul><li><ul><li>winpeshl.ini;</li></ul></li></ul><pre tabindex=0><code>[LaunchApps]
&#34;install.bat&#34;
</code></pre><ul><li>На ноутбуке набираем</li><li><ul><li>chain http://MACBOOKIP:8000/boot.ipxe</li></ul></li><li>Загружается windows PE;</li><li>Через утилиту diskpart определяем какие есть диски, партишены и волюмы;</li><li>Переходим к установочным файлам, набираем setup.exe;</li><li>Устанавливаем Windows 7.</li></ul><h1 id=проблема-1>Проблема №1</h1><p>Флешка была отформатирована в exfat. Windows 7 не понимает данную файловую систему.</p><p><strong>Решение</strong> - с официального сайта Microsoft скачивает официальный образ Windows 11. Оттуда скачиваем нужные файлы.
Загружаемся еще раз на ноутбуке, в этот раз загрузится 11 версия WinPE, которая умеет работать с exfat волюмами.</p><h1 id=проблема-2>Проблема №2</h1><p>Windows 11 нужен bootmgr, fonts.</p><p><strong>Решение</strong> - скачиваем эти файлы с официального образа.</p><h1 id=проблема-3>Проблема №3</h1><p>WSUS Offline не поддерживает Windows 7.</p><p><strong>Решение</strong> - После некоторого времени поиска в Google был найден форум, на котором был дан <a href=https://www.eevblog.com/forum/general-computing/updating-windows-7/msg4239211/#msg4239211>рецепт как обновить Windows Updates для Windows 7</a>.
Чтобы не потерять, я скопирую сюда рецепт</p><pre tabindex=0><code>To get up to date, you&#39;ll then need to download these and INSTALL THEM IN THIS ORDER :
KB2533552 : https://www.catalog.update.microsoft.com/Search.aspx?q=kb2533552
Download the one without &#34;Embedded&#34; in text. It updates the &#34;Windows Update&#34; within Windows 7 to accept the big Service Pack 1 package (without it, it will take literally hours for the Service Pack 1 to install)
KB976932 :  https://www.catalog.update.microsoft.com/Search.aspx?q=KB976932
You&#39;ll want the one in the middle, titled &#34;Windows 7 Service Pack 1 for x64-based Systems (KB976932)&#34;, 912.4 MB
From there, you have the unofficial service Pack 2 called &#34;Convenience Rollup Update for Windows 7 SP1 and Windows 2008&#34; : https://support.microsoft.com/en-us/topic/convenience-rollup-update-for-windows-7-sp1-and-windows-server-2008-r2-sp1-da9b2435-2a1c-e7fa-43f5-6bfb34767d65
In order to be able to install it, you need to first install:
KB30200369 : April 2015 servicing stack update for Windows 7 and Windows Server 2008 R2  : https://www.catalog.update.microsoft.com/Search.aspx?q=KB3020369
Second link is for 64 bit version - it&#39;s another update for &#34;Windows update&#34; to allow installing lots of updates in one shot
Then the actual cumulative update :
KB3125574 : Update for Windows 7 for x64-based Systems (KB3125574)  : https://www.catalog.update.microsoft.com/search.aspx?q=kb3125574
Last one in the list is for 64 bit, 477 MB.
Then you should be able to just get the latest cumulative security updates which is a package of security updates from this &#34;SP2&#34; until the end
Again, you need to install some small updates to be able to install the big update
KB4490628  2019-03 Servicing Stack Update for Windows 7 for x64-based Systems (KB4490628)  : https://www.catalog.update.microsoft.com/Search.aspx?q=KB4490628
KB4474419 : a hashing/encryption library update , library is used by windows update (last entry is windows 7 64 bit) :  https://www.catalog.update.microsoft.com/Search.aspx?q=KB4474419
KB4536952 : another &#34; windows update&#34; update : https://www.catalog.update.microsoft.com/Search.aspx?q=KB4536952
and now you can actually get the last package of updates
kb4534310 : Security rollup  : https://www.catalog.update.microsoft.com/Search.aspx?q=KB4534310
Second link is Windows 7 64 bit
</code></pre><h1 id=проблема-4>Проблема №4</h1><p>Драйвера</p><p><strong>Решение</strong> - Нам поможет <a href="https://sdi-tool.org/?lang=ru">Snappy Driver Installer</a>.</p><ul><li>Необходимо скачать торрент;</li><li>загрузить полный комплект файлов;</li><li>перекинуть файлы ноутбук - может занять очень много времени (около 37 ГБ данных);</li><li>запустить Snappy Driver Installer;</li><li>подождать, перезагрузится;</li><li>еще раз запустить Snappy Driver Installer до тех пор пока все драйвера не будут установлены.</li></ul><h1 id=проблема-5>Проблема №5</h1><p>Не получается установить <a href=https://chocolatey.org/>Chocolatley</a>.</p><p><strong>Решение</strong></p><ul><li>Нужно установить DotNet 4.7;</li><li>обновить Powershell до 3 версии;</li><li>установить Chocolatley по <a href=https://chocolatey.org/install>официальной инструкции по установке</a>;</li><li>обновить powershell до 5 версии через choco install powershell.</li></ul><h1 id=links>Links</h1></div><footer class=entry-footer><div class='container sep-before'><div class=categories><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>categories: </span><a class=category href=/blog/category/windows/>windows</a>, <a class=category href=/blog/category/ipxe/>ipxe</a>, <a class=category href=/blog/category/wimboot/>wimboot</a>, <a class=category href=/blog/category/winpe/>winpe</a>, <a class=category href=/blog/category/python/>python</a>, <a class=category href=/blog/category/updates/>updates</a>, <a class=category href=/blog/category/chocolatley/>chocolatley</a>, <a class=category href=/blog/category/powershell/>powershell</a></div></div></footer></article><nav class=entry-nav><div class=container><div class='prev-entry sep-before'><a href=/blog/2022/06/27/lazy-automation/><span aria-hidden=true><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg></span><span class=screen-reader-text>: </span>Ленивая автоматизация</a></div><div class='next-entry sep-before'><a href=/blog/2023/08/02/jq-looping-simple-example/><span class=screen-reader-text>: </span>Простой пример работы с массивами в jq<span aria-hidden=true><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav><section id=comments class=comments><div class='container sep-before'><div class=comments-area><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hdfilm-2.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></section></main><footer id=footer class=footer><div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label><ul><li><a href=https://github.com/Nurmukhamed target=_blank rel=noopener><span class=screen-reader-text></span><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=mailto:nurmukhamed.artykaly@hdfilm.kz target=_blank rel=noopener><span class=screen-reader-text></span><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://t.me/nartykaly target=_blank rel=noopener><span class=screen-reader-text></span><svg class="icon" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="m22.05 1.577c-.393-.016-.784.08-1.117.235-.484.186-4.92 1.902-9.41 3.64-2.26.873-4.518 1.746-6.256 2.415C3.53 8.537 2.222 9.035 2.153 9.059c-.46.16-1.082.362-1.61.984-.79581202 1.058365.21077405 1.964825 1.004 2.499 1.76.564 3.58 1.102 5.087 1.608.556 1.96 1.09 3.927 1.618 5.89.174.394.553.54.944.544l-.002.02s.307.03.606-.042c.3-.07.677-.244 1.02-.565.377-.354 1.4-1.36 1.98-1.928l4.37 3.226.035.02s.484.34 1.192.388c.354.024.82-.044 1.22-.337.403-.294.67-.767.795-1.307.374-1.63 2.853-13.427 3.276-15.38L23.676 4.725C23.972 3.625 23.863 2.617 23.18 2.02 22.838 1.723 22.444 1.593 22.05 1.576z"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2009-2023 Nurmukhamed Artykaly</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.67d669ac.js></script><script src=/js/custom.js></script></body></html>